

<script src="../assets/js/stanza.js"></script>
<script>
  (function() {
    const descriptor = {"templates":{"stanza.html":"\u003cstyle type=\"text/css\"\u003e\nmain {\n    -sebkit-box-shadow: none;\n    box-shadow: none;\n}\na {\n    color: #007fb1;\n    text-decoration: none;\n}\na:active, a:hover {\n    color: #007fb1;\n    text-decoration: underline;\n}\ndiv.center {\n  /*  text-align: center; */\n}\ntable.info_table {\n    margin: 0 auto;\n    border-collapse: collapse;\n    font-size: 14px;\n}\ntable.sub_info_table{\n    border-collapse: collapse;\n    width: 100%\n}\ntable.info_table td {\n    padding: 10px 0px 10px 0px;\n    border-bottom: solid 1px #000000;\n}\ntable.info_table td.info_table_label {\n    padding-right: 40px;\n    font-weight: bold;\n}\ntable.sub_info_table th {\npadding: 0px 40px 0px 0px;\n    text-align: left;\n    border-bottom: solid 1px #000000;\n}\ntable.sub_info_table td{\n    padding: 10px 40px 0px 0px;\n    text-align: left;\n    border: none;\n}\n\n.sequence {\n    word-break: break-all;\n    word-wrap: break-word;\n    white-space: pre-wrap;\n    font-family: Monaco,Menlo,Consolas,\"Courier New\",monospace;\n}\nul.info_table_list {\n    list-style: none;\n    margin: 0px;\n    padding: 0px;\n}\nul.info_table_list li {\n    line-height: 24px;\n    clear: both;\n}\nul.table_style {\n    display: table;\n    margin: 0px;\n}\nli.list_label {\n    display: table-cell;\n    text-align: left;\n    min-width: 200px;\n}\nli.list_value {\n    display: table-cell;\n    text-align: right;\n    min-width: 100px;\n}\nspan.unmatch {\n    color: #8888ff;\n}\n\n\u003c/style\u003e\n\n\u003cdiv id=\"draw_area\" class=\"center\"\u003e\n  \u003ctable class=\"info_table\"\u003e\n    \u003ctr\u003e\n      \u003ctd class=\"info_table_label\"\u003eSequence\u003c/td\u003e\n      \u003ctd class=\"sequence\"\u003e{{result.sequence}}\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd class=\"info_table_label\"\u003eStatistics\u003c/td\u003e\n      \u003ctd\u003e\n\t\u003cul class=\"info_table_list\"\u003e \n      \t  \u003cli\u003e\u003cul class=\"table_style\"\u003e\u003cli class=\"list_label\"\u003eLength\u003c/li\u003e\u003cli class=\"list_value\"\u003e{{result.length}}\u003c/li\u003e\u003c/ul\u003e\u003c/li\u003e\n\t  \u003cli\u003e\u003cul class=\"table_style\"\u003e\u003cli class=\"list_label\"\u003e# PSMs\u003c/li\u003e\u003cli class=\"list_value\"\u003e{{result.psm_count}}\u003c/li\u003e\u003c/ul\u003e\u003c/li\u003e\n\t\u003c/ul\u003e\n      \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd class=\"info_table_label\"\u003ePeptide type\u003c/td\u003e\n      \u003ctd\u003e{{result.type}}\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd class=\"info_table_label\"\u003eProtein\u003c/td\u003e\n      \u003ctd\u003e\n        \u003ctable class=\"sub_info_table\"\u003e\n\t  \u003ctr\u003e\u003cth\u003eProtein ID\u003c/th\u003e\u003cth\u003eUniProt ID\u003c/th\u003e\u003cth\u003eAccession\u003c/th\u003e\u003cth\u003eGene name\u003c/th\u003e\u003cth\u003eLocation\u003c/th\u003e\u003c/tr\u003e\n\t  {{#each result.protein}}\n\t  \u003ctr\u003e\u003ctd\u003e\u003ca href=\"./protein.php?id={{uniprot}}\"\u003e{{prt_id}}\u003c/a\u003e\u003c/td\u003e\u003ctd\u003e{{mnemonic}}\u003c/td\u003e\u003ctd\u003e\u003ca href=\"http://www.uniprot.org/uniprot/{{uniprot}}\"\u003e{{uniprot}}\u003c/a\u003e\u003c/td\u003e\u003ctd\u003e{{gene_name}}\u003c/td\u003e\u003ctd\u003e{{begin}}..{{end}}\u003c/td\u003e\u003c/tr\u003e\n\t  {{/each}}\n\t\u003c/table\u003e\n      \u003c/td\u003e\n    \u003c/tr\u003e\n    {{#if result.mod}}\n    \u003ctr\u003e\n      \u003ctd class=\"info_table_label\"\u003eModification\u003c/td\u003e\n      \u003ctd\u003e\n\t\u003ctable class=\"sub_info_table\"\u003e\n\t  \u003ctr\u003e\u003cth\u003ePosition\u003c/th\u003e\u003cth\u003eModification\u003c/th\u003e\u003cth\u003eSite\u003c/th\u003e\u003c/tr\u003e\n\t  {{#each result.mod}}\n\t  \u003ctr\u003e\u003ctd\u003e{{position}}\u003c/td\u003e\u003ctd\u003e{{mod}}\u003c/td\u003e\u003ctd\u003e{{site}}\u003c/td\u003e\u003c/tr\u003e\n\t  {{/each}}\n\t\u003c/table\u003e\n      \u003c/td\u003e\n    \u003c/tr\u003e\n    {{/if}}\n    {{#if result.sim_pep}}\n    \u003ctr\u003e\n      \u003ctd class=\"info_table_label\"\u003eCommon peptide\u003cbr\u003eat MS level\u003c/td\u003e\n      \u003ctd\u003e\n\t\u003ctable class=\"sub_info_table\"\u003e\n\t  \u003ctr\u003e\u003cth\u003ePeptide ID\u003c/th\u003e\u003cth\u003eSequence\u003c/th\u003e\u003c/tr\u003e\n\t  {{#each result.sim_pep}}\n\t  \u003ctr\u003e\n\t    \u003ctd\u003e\u003ca href=\"./peptide?id={{pep_id}}\"\u003e{{pep_id}}\u003c/a\u003e\u003c/td\u003e\u003ctd class=\"sequence\"\u003e{{#each sequence}}{{#if matched}}{{matched}}{{/if}}{{#if unmatched}}\u003cspan class=\"unmatch\"\u003e{{unmatched}}\u003c/span\u003e{{/if}}{{/each}}\u003c/td\u003e\n\t  \u003c/tr\u003e\n\t  {{/each}}\n\t\u003c/table\u003e\n      \u003c/td\u003e\n    \u003c/tr\u003e\n    {{/if}}\n  \u003c/table\u003e\n\u003c/div\u003e\n"},"parameters":["peptide"],"elementName":"togostanza-table_peptide","development":true};

    if ('Promise' in window && 'URLSearchParams' in window && 'fetch' in window) {
      const Stanza = TogoStanza.initialize(descriptor);

      Stanza(function(stanza, params) {

    var formBody = [];
    for (var key in params) {
	if(params[key]) formBody.push(key + "=" + encodeURIComponent(params[key]));
    }

    var options = {
	method: "POST",
	mode:  "cors",
	body: formBody.join("&"),
	headers: {
	    "Accept": "application/json",	    
	    'Content-Type': 'application/x-www-form-urlencoded'
	}
    };

  let env = "tools";
  if(location.host.match("db-dev")) env = "db-dev";
  let api = document.location.protocol + "//" + env + ".jpostdb.org/rest/api/";
    var name = "table_items_peptide";
    if(params.peptide.match(/^[A-Z]+$/)) name = "table_items_peptide_sequence";
    
    var q = fetch(api + name, options).then(res => res.json());

    q.then(function(data){
	stanza.render({
	    template: "stanza.html",
	    parameters: {
		result: data
	    }
	});
    });
});


    } else {
      const element = document.querySelector(descriptor.elementName);

      element.innerHTML = "<p>Your Web browser does not support the features required for the stanza to work. If you are using Internet Explorer 11, placing the following snippet before loading webcomponents-loader.js may resolve this issue:</p>\n<pre><code>&lt;script src=\"https://cdn.jsdelivr.net/combine/npm/@babel/polyfill@7.2.5/dist/polyfill.min.js,npm/@ungap/url-search-params@0.1.2/min.js,npm/whatwg-fetch@3.0.0/dist/fetch.umd.js\" crossorigin&gt;&lt;/script&gt;</code></pre>";
    }
  })();
</script>
